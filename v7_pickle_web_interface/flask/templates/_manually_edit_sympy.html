{% macro manually_edit_sympy(dat, expr_global_id, revised_text_form, latex_generated_by_sympy )  %}
      <fieldset>
        <legend><h4>Manually edit the SymPy expression (global change)</h4></legend>
        <form method="post" action=""> <!-- onsubmit="return checkForm(this);"> -->
        {{ revised_text_form.csrf_token }}
          <div class="form-group">
            <div class="input-group">
              <P>
                Current expression in SymPy:<BR>
<pre>
{{ dat["expressions"][ expr_global_id ]["AST"] }}
</pre>
                  \(\rm\LaTeX\) expression generated by SymPy from AST:
                  <P>
                    \({{ latex_generated_by_sympy[ expr_global_id ] }}\)
<P>Compare to the \(\rm\LaTeX\)
  <P>
  \({{ dat['expressions'][expr_global_id]['latex'] }}\)
              <P>
                If the SymPy is incorrect,
              <P>
                {{ revised_text_form.revised_text.label }}: {{ revised_text_form.revised_text(size=150, maxlength=1000) }} <small>max length = 1000 characters</small>
            </div>
            <input type="submit" name="submit_button" value="update expression sympy {{ expr_global_id }}">
            <P>
              <I>Caveat</I>: altering the SymPy does not change the \(\rm\LaTeX\) expression.<BR>
                <!--
                  If the \(\rm\LaTeX\) is wrong, use
                  <input type="submit" name="submit_button" value='modify this step'>
                -->
          </div>
        </form>
      </fieldset>

{% endmacro %}
